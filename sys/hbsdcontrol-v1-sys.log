commit 49321a7f39f94197fb29627796a162c4c2761833
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Mon May 1 23:30:50 2017 +0200

    HBSD: optimize the hbsdcontrol's kernel side function, and use proper nameing
    
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit b83e153fa7ce66d13f48e529307c4e9fb2c91c9f
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Mon May 1 23:04:39 2017 +0200

    HBSD: add short disclamer, why NOCRED is used in hbsdcontrols kernel part
    
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 263a376463884fe372669bd6714f3f3323f1a3e6
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Tue Jan 3 21:33:38 2017 +0100

    HBSD: fix build error on 10-STABLE
    
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 3aba3b65ed8260e2ba2d3cdf211c2a4387387049
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sun Jan 1 19:04:07 2017 +0100

    HBSD: final cleanups in hbsdcontrol branch
    
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 2969f3eb6781778057d9f0ff33f5c98ff3686e56
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Wed Dec 28 14:17:10 2016 +0100

    HBSD: do not query for non-existent FS-EAs
    
    In case when only some of hbsdcontrol related extended attributes
    assigned to an executable, filter out the not assigend attributes
    from list of requested from VOP_GETEXTATTR calls. With this trick
    we can eliminate the unneeded heavyweight VOP_* functions.
    
    Also added a fast-path to non-existing FS-EA-s and error cases too.
    
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 4df22fb5dfe957c2c0176a1ce9f575b47dcbfb8a
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Tue Dec 27 01:05:09 2016 +0100

    HBSD: simplify the option parsing from FS-EA-s in hbsdcontrol
    
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 49da176d58e10d20f0464225fc5480ef5285b218
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Tue Dec 27 00:55:31 2016 +0100

    HBSD: fix error handling in hbsdcontrol's kernel code
    
    In case of ENOATTR previously the parsed_flags always zeroed out,
    what is a wrong behaviour. This case occurs when only one property
    is set, and it's safe to ignore this type of error.
    
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit fb812719ba08f8d2f27a7199f755cd35fc92e99f
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Thu Nov 17 21:40:47 2016 +0100

    HBSD: use the correct option PAX_OVERRIDE_WITH_ACL
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit e501e8f8643170b73c2ade93ad6bad26dd5ddcc2
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sun Nov 6 20:08:26 2016 +0100

    HBSD: document the newly added kernel knobs
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 33a2671f65eb952fcc8fde77e045b05caf193c98
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sun Nov 6 20:06:23 2016 +0100

    HBSD: added PAX_ACL and PAX_OVERRIDE_WITH_ACL to keep old behavior
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 392901c5e8e558010eabb26cef8dbd61e5f121ba
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sun Nov 6 20:03:21 2016 +0100

    HBSD: use the proper reference to thread in pax_hbsdcontrol_parse_fsea_flags()
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 39b867dd64131b43a2e05b2e4330ce98f4727b8b
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sun Nov 6 20:01:37 2016 +0100

    HBSD: API change, swap the first and second argument of pax_elf
    
    Follow the style of other parts of the code.
    This requires a __HardenedBSD_version bump after the merge.
    The required changes was already done in secadm's hbsdcontrol branch.
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit ac4599da069177507d173b43978385f146e95c44
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sun Nov 6 19:54:40 2016 +0100

    HBSD: allow to override hbsdcontrol's settings with secadm when allowed
    
    This introduces two new kernel knob:
     * PAX_ACL - when this is included in kernel config, the default is
       included, then you are able to use secadm, when not, the secadm
       lost it's functionality. This is the minimum required framework
       for secadm.
     * PAX_OVERRIDE_WITH_ACL - once you added this knob to kernel config
       then you are able to override the default settings or the hbsdcontrol
       settings with secadm. Without this knob you cannot set pax settings
       with secadm and you could use only a subset of secadms functionality.
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit d87eff686ed2296e6404c5b2e069af5c0ca38b33
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sun Nov 6 19:19:18 2016 +0100

    HBSD: fix possible TOCTOU in hbsdcontrol
    
    As side-effect when hbsdcontrol is compiled in, then always overrides the secadm settings.
    This is because secadm is running in exec_check_premission()'s mac_vnode_check_exec().
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 744b18bd0c9bf35ac2cfe870720aea6b9eea5490
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sun Nov 6 18:56:03 2016 +0100

    HBSD: follow namespace change in user-land part too
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit ad2ee5eeb4dc33d3bbe37bed6a00f937d93040fa
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sun Nov 6 18:53:21 2016 +0100

    HBSD: change hbsdcontrol's namespace in FS-EAs
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit c236d7fef91775f0048ae7dbe66050bc68d79fb5
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sun Nov 6 18:52:24 2016 +0100

    HBSD: add the ability to disable hbsdcontrol at boot time via tunable
    
    Set hardening.hbsdcontrol.status to 0 to disable and 1 to enable them.
    The default is 1.
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 5e8bc5d3f5c574d47f87b661da5ee7f0a1afea73
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sun Nov 6 18:49:49 2016 +0100

    HBSD: remove unneeded KASSERTS and improve style in hbsdcontrol's system part
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit fd87fabe4a7c65865dc6b392b62901a0dd4f0c54
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sat Jan 23 23:27:41 2016 +0100

    HBSD: follow type changes in hbsdcontrol, what are introduced in v40
    
    MFC-to: 10-STABLE
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 5cf8083f2c0d4820703057d9699815010391a6f1
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Tue Jan 19 22:55:18 2016 +0100

    HBSD: use NOCRED instead of NULL as credential parameter in VOP_GETEXTARTTR call
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit ba889d4811dcff3b7313f75bcd91be3a2920277c
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sun Jan 17 20:20:23 2016 +0100

    HBSD: bump copyright year, and change SI_ORDER_FIRST to SI_ORDER_SECOND
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 14a33b17c84d5b121e85a628a5c367f0ca1dd7c3
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Thu Jan 14 23:34:26 2016 +0100

    HBSD: drop the check against credentials when try to pull in pax settings
    
    This fixes the case, when running program with special settings other than root user.
    
    github-isue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 14e2abd630c66a2881e4fabbfbc53ccbd5a4d6ef
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sat Jan 9 18:28:33 2016 +0100

    HBSD: properly set feature statuses with hbsdcontrol
    
    github-isue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 722e6cab6c790b3633d5369f16cb9d119b3e2e2e
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sat Jan 9 15:18:33 2016 +0100

    HBSD: simplify the FS-EA handling
    
    The best would be to move the whole setup after the
    exec_check_permissions function, to properly close the TOCTOU,
    but first I like to test the overall scenario.
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit b6d4d5add61d45d0b527184b60f00574f51437b3
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sat Dec 5 22:37:24 2015 +0100

    HBSD: make the feature names uniform
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 78714074b2ae797b2236d88ddc94562caa3824c5
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sat Dec 5 21:39:07 2015 +0100

    HBSD: add hbsdcontrol PoC to /sbin
    
    boot: change/set/get settings in /boot/loader.conf - not yet implemented
    global: change/set/get sysctl settings runtime implemented, /etc/sysctl.conf not yet implemented
    system: change/set/get attribute in file's FS extended attribute system namespace
    user: change/set/get attribute in file's FS extended attribute user namespace,
     not this require write permisson to file
    
    some example run:
    
    op@opn hbsdcontrol> ./hbsdcontrol.sh boot
    not implemented - missing hbsdcontrol.sh support
    op@opn hbsdcontrol> ./hbsdcontrol.sh global
    ./hbsdcontrol.sh: <class> <feature> <state>
            <class> := (boot|global|system|user)
            <feature> := (aslr|pageexec|mprotect|segvguard|disallow_map32bit)
    
    op@opn hbsdcontrol> ./hbsdcontrol.sh system
    ./hbsdcontrol.sh: <class> <feature> <state> file
            <class> := (boot|global|system|user)
            <feature> := (aslr|pageexec|mprotect|segvguard|disallow_map32bit|shlibrandom)
    
    op@opn hbsdcontrol> ./hbsdcontrol.sh user
    not implemented - missing kernel support
    ./hbsdcontrol.sh: <class> <feature> <state> file
            <class> := (boot|global|system|user)
            <feature> := (aslr|pageexec|mprotect|segvguard|disallow_map32bit|shlibrandom)
    
    op@opn hbsdcontrol> ./hbsdcontrol.sh global aslr status
    hardening.pax.aslr.status: 2
    
    op@opn hbsdcontrol> ./hbsdcontrol.sh user aslr status /tmp/ls
    not implemented - missing kernel support
    getextattr: /tmp/ls: failed: Attribute not found
    
    op@opn hbsdcontrol> ./hbsdcontrol.sh user aslr enable /tmp/ls
    not implemented - missing kernel support
    
    op@opn hbsdcontrol> ./hbsdcontrol.sh user aslr status /tmp/ls
    not implemented - missing kernel support
    /tmp/ls 1
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 5ddeeaa762c5680e0f901c9376bff6ba15467130
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sat Dec 5 02:32:06 2015 +0100

    HBSD: add basic functionality and hook in into kern_exec
    
    * parese the assigned options
    * pass them to pax_elf
    * currently missing user namespace
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit 6d3ca35a2036b09eccde14e38ea149143bbe5c8c
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sat Dec 5 01:51:17 2015 +0100

    HBSD: add basic stubs for hbsdcontrols kernel site implementation
    
    github-issue: #30
    github-issue: #179
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>

commit bbf5c24db47828286b4ca19c2552992a73ee76e8
Author: Oliver Pinter <oliver.pinter@hardenedbsd.org>
Date:   Sat Dec 5 19:46:00 2015 +0100

    HBSD XXX: added dev tools under tools/hardenedbsd
    
    Signed-off-by: Oliver Pinter <oliver.pinter@hardenedbsd.org>
